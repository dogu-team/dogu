---
sidebar_position: 3
title: Write
locale: en
---

When you clone the test script repository, a basic template project is prepared.<br/>

:::caution
The test script explains how to write and run a script using the `Dest` library.<br/>
Please refer to [Gamium Documentation](https://gamium.dogutech.io/docs/get-started/introduction) for how to write a `Gamium` test script.
:::

:::info Set test script directory
Set test script directories in `scriptFolderPaths` in the `dost.config.json` configuration file.<br/>
By default, the `test` directory is set.
:::

## Dest library description

This library is used to create each test (test case) and job (test suite), which is a set of test cases.<br/>
If you write a test script using the Dest library, you can check the execution result of the test case in the result report after executing the routine.

### `Dest.describe((context: DestContext) => void)`

`describe()` is a function for creating a test set.<br/>
Context includes loggers used inside dest.

### `Dest.withOptions(options: DestOptions).describe((context: DestContext) => void)`

`withOptions()` allows you to change option values ​​instead of default options. <br/>
Options are described below.

### `job(name, () => void)`

`job()` is a set of test cases.<br/>
At least one job is required.<br/>
Jobs can be nested.

### `test(name, () => Promise<void> | void)`

`test()` is a function that runs a test case.<br/>
Can only be used inside a job.<br/>
If a test case fails, the next test case will not run and the job will fail.

### `beforeAll(() => Promise<void> | void)`

Runs before all tests at the same level run.

### `afterAll(() => Promise<void> | void)`

Runs after all tests at the same level have run.

### `beforeEach(() => Promise<void> | void)`

Each test at the same level is run before each run.

### `afterEach(() => Promise<void> | void)`

Runs after each test at the same level has run.

## Options

| Properties | Required/Optional | Type    | Default | Description                 |
| :--------- | :---------------- | :------ | :------ | :-------------------------- |
| timeout    | Optional          | number  | 60000   | Execution time limit(ms)    |
| logToFile  | Optional          | boolean | false   | Whether log files are saved |

## Usage guide

### Run with default options

If `Dest.withOptions()` is not used, it will be executed with default options.

```typescript
import { Dest, job, test } from '@dogu-tech/dest';

Dest.describe(({ logger }) => {
  job('my first test', () => {
    test('my first test case', () => {
      logger.info('hello world');
    });
  });
});
```

### Execute after changing options

If you use `Dest.withOptions()`, you can change the option values ​​instead of the default options.<br/>

```typescript
import { Dest, job, test } from '@dogu-tech/dest';

Dest.withOptions({
  timeout: 60 * 60 * 1000, // 1 hour
  logToFile: true,
}).describe(({ logger }) => {
  job('my first test', () => {
    test('my first test case', () => {
      logger.info('hello world');
    });
  });
});
```

### If there is no job

At least one job is required.<br/>
An exception is thrown if the job does not exist.

```typescript
import { Dest, job, test } from '@dogu-tech/dest';

Dest.describe(({ logger }) => {
  // ❌ this will throw an error. you must use job() to create a job.
  test('my first test case', () => {
    logger.info('hello world');
  });

  // ✅ this is ok.
  job('my first job', () => {
    test('my first test case', () => {
      logger.info('hello world');
    });
  });
});
```

### If there are nested jobs

```typescript
import { Dest, job, test } from '@dogu-tech/dest';

Dest.describe(({ logger }) => {
  // ✅ nested jobs
  job('my first test', () => {
    job('my nested test', () => {
      test('my second test case', () => {
        logger.info('hello world');
      });
    });
  });

  // ❌ nested tests. this will throw an error.
  job('my second test', () => {
    test('my second test case', () => {
      test('my nested test case', () => {
        logger.info('hello world');
      });
    });
  });
});
```

### When using beforeAll and afterAll

Can be used for prep work or cleanup.

```typescript
import { afterAll, beforeAll, Dest, job, test } from '@dogu-tech/dest';

Dest.describe(({ logger }) => {
  job('my first test', () => {
    beforeAll(() => {
      logger.info('beforeAll');
    });

    // this called after same level tests
    afterAll(() => {
      logger.info('afterAll');
    });

    test('my first test case', () => {
      logger.info('hello world');
    });

    test('my second test case', () => {
      logger.info('hello world');
    });
  });
});
```

output result:

```sh
 my first test
  ✓ beforeAll (0.0s)
  ✓ my first test case (0.0s)
  ✓ my second test case (0.0s)
  ✓ afterAll (0.0s)
```

### When using beforeEach and afterEach

You can use it for initialization or cleanup for each test case..

```typescript
import { afterEach, beforeEach, Dest, job, test } from '@dogu-tech/dest';

Dest.describe(({ logger }) => {
  job('my first test', () => {
    beforeEach(() => {
      logger.info('beforeEach');
    });

    // this called after each test
    afterEach(() => {
      logger.info('afterEach');
    });

    test('my first test case', () => {
      logger.info('hello world');
    });

    test('my second test case', () => {
      logger.info('hello world');
    });
  });
});
```

output result:

```sh
my first test
  ✓ beforeEach (0.0s)
  ✓ my first test case (0.0s)
  ✓ afterEach (0.0s)
  ✓ beforeEach (0.0s)
  ✓ my second test case (0.0s)
  ✓ afterEach (0.0s)
```

### When timeout occurs

The timeout option allows you to limit how long the test runs.<br/>
If a timeout occurs, the test is treated as a failure.

```typescript
import { Dest, job, test } from '@dogu-tech/dest';

Dest.withOptions({
  timeout: 1000, // 1 seconds
}).describe(({ logger }) => {
  job('my first test', () => {
    test('my first test case', () => {
      logger.info('hello world');
    });

    test('my second test case', async () => {
      logger.info('hello world');
      await new Promise((resolve) => setTimeout(resolve, 2000));
    });
  });
});
```

output result:

```sh
  FAIL
 my first test
  ✓ my first test case (0.0s)
  ✕ my second test case (1.0s)
```
