---
sidebar_position: 3
title: Self-Hosted Dogu
locale: ko
---

import {
  getBrowserPlatform,
  BrowserPlatform,
} from '@site/src/platform/platform.ts';

import dost_macos_api_url_input from '@site/static/img/dost/dost_macos_api_url_input.png';
import dost_windows_api_url_input from '@site/static/img/dost/dost_windows_api_url_input.png';

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import BrowserOnly from '@docusaurus/BrowserOnly';

:::info PREREQUISITES
이 문서는 Dogu를 Self-Hosted로 시작하는 방법에 대해 설명합니다.
:::

self-hosted 방식으로 도구를 셋팅할 수 있습니다.

## 하드웨어 요구사항

|                          | Minimum Requirements                           |
| :----------------------: | ---------------------------------------------- |
| <b>Operating System</b>  | Ubuntu(x86_64), macOS(x86_64), Windows(x86_64) |
|       <b> CPU </b>       | 8 Cores                                        |
|     <b> Memory </b>      | 16 GB RAM                                      |
| <b> Free Disk Space </b> | SSD 128GB                                      |
|  <b> Dependencies </b>   | Docker, Docker-Compose                         |

## Dogu 설치

### 볼륨 경로 생성

<Tabs groupId="os" defaultValue="linux">
<TabItem value="linux" label="Linux" default>

```
sudo mkdir /var/lib/dogu
sudo mkdir /var/lib/dogu/nexus-data
sudo chown 200 -R /var/lib/dogu/nexus-data
```

</TabItem>

<TabItem value="windows" label="Windows">

```
icacls "C:\var\lib\dogu\nexus-data" /setowner 200 /T
```

</TabItem>
</Tabs>

:::note
위에서 생성한 `/var/lib/dogu` 경로를
다음 단계에서 생성할 docker-compose.env 파일의 `VOLUME_PATH` 값으로 대체해도 괜찮습니다.
:::

### docker-compose.env 파일 생성

1. 빈 docker-compose.env 파일 생성
2. [파일](https://github.com/dogu-team/dogu/blob/main/docker-compose.env) 내용을 docker-compose.env 파일에 붙여넣기

:::note
GITLAB_ROOT_ACCESS_TOKEN 값은
Dogu 실행 후 아래 [gitlab root Access Token 발급 받기](/self-hosted/get-started#gitlab-root-access-token-발급-받기)에서 token을 발급받은 후 재설정 해 주세요.
:::

### docker-compose.yml 설정

1. 빈 docker-compose.yml 파일 생성
2. [파일](https://github.com/dogu-team/dogu/blob/main/docker-compose.yml) 내용을 docker-compose.yml 파일에 붙여넣기

### Dogu 실행

docker-compose.env, docker-compose.yml 파일이 있는 디렉토리에서 아래 명령어를 실행합니다.

```
docker compose -f ./docker-compose.yml --env-file ./docker-compose.env up  -d
```

### gitlab root Access Token 발급 받기

Dogu를 실행하기 위해서는 gitlab의 root access token이 필요합니다.
아래는 gitlab의 root access token을 발급하는 방법입니다.

- gitlab 접속하기
  - docker-compose.env에 지정한 DOGU_HOST의 주소 값과 8080포트로 접속합니다.
    :::info
    ex. localhost:8080 ( gitlab이 실행되는 데 약 5분 정도 걸립니다 )
    :::
- gitlab root 계정 로그인

  - docker-compose.env에 지정한 GITLAB_ROOT_PASSWORD로 로그인 합니다.
    <img
      src="/ko/img/get-started/gitlab-login.png"
      style={{ width: 400, display: 'block' }}
    />

- Access token 발급하기

  - GitLab에서 우측 상단에 있는 아바타를 클릭, Edit profile 선택합니다.
  - User Settings 페이지의 왼쪽 사이드바에서 Access Tokens를 클릭합니다.
  - 아래 내용을 설정하고 토큰을 생성합니다.

    - Token name을 작성합니다.
    - Expiration data에서 x버튼을 클릭하여 만료기간을 없앱니다.
    - Select scopes를 모두 클릭합니다.
      <img
        src="/ko/img/get-started/gitlab-issue-access-token.png"
        style={{ width: 400, display: 'block' }}
      />

  - 생성된 Access Token을 확인합니다
    <img
      src="/ko/img/get-started/gitlab-check-access-token.png"
      style={{ width: 400, display: 'block' }}
    />

### gitlab Access Token 설정하기

위 단계에서 생성한 docker-compose.env에 GITLAB_ROOT_ACCESS_TOKEN에 위에 값을 추가로 설정합니다.

```
ex. GITLAB_ROOT_ACCESS_TOKEN=glpat-Z5Zq-XkrtKjzq5FiAMAA
```

### Dogu 재실행

docker-compose.env, docker-compose.yml 파일이 있는 디렉토리에서 아래 명령어를 실행합니다. ( 이전에 실행했던 docker-compose는 중지할 필요 없습니다.)

```
docker compose -f ./docker-compose.yml --env-file ./docker-compose.env up  -d
```

### 웹 페이지

Dogu Console: DOGU_HOST:3001  
Dogu Gitlab: DOGU_HOST:8080

### Dost 설치

다운로드 후 설치는 [Dost 설치](/host-and-device/host/get-started#설치)를 참고해주세요.

### Dost 실행

dogu console에 연결할 수 있는 dost를 실행합니다.

- Dost 접속 환경 설정

  - [docker-compose.env 파일 생성](/self-hosted/get-started#docker-composeenv-파일-생성)에서 설정한 DOGU_HOST값을 사용하여 접속 URL을 설정합니다.
    `ex. localhost:4000`

  <BrowserOnly>
    {() => (
      <Tabs groupId="os" defaultValue={getBrowserPlatform('windows')}>
        <TabItem value="windows" label="Windows" default>
          <img src={dost_windows_api_url_input} style={{ width: 600 }} />
        </TabItem>
        <TabItem value="macos" label="macOS">
          <img src={dost_macos_api_url_input} style={{ width: 600 }} />
        </TabItem>
      </Tabs>
    )}
  </BrowserOnly>

## 디바이스를 디바이스 팜에 연결하기

[Quick start - Device farm](/ko/get-started/device-farm) 문서에서 확인할 수 있습니다.

## NOTICE

사용 가능한 gitlab 버전은 15.10.0입니다. (gitlab security warning, upgrade 권장 노출은 무시해주세요.)
